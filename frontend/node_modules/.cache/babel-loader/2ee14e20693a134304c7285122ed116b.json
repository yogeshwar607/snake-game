{"ast":null,"code":"var _jsxFileName = \"/Users/yogi/Code/pe/deep-dive-v1kasjain/projects-exercises/multiplayer-snake-game/frontend/src/Game.js\";\nimport React, { useState, useEffect } from \"react\";\nimport GameStart from \"./GameStart\";\nimport GameOver from \"./GameOver\";\nimport { randomPosition, getRowsColumns, displayGrid, useInterval, displayScore } from \"./GameHelper\";\nimport GameInput from \"./GameInput\";\nimport { subscribeToTimer } from './Api';\nimport SnakeCanvas from './canvas';\n\nconst Game = () => {\n  const height = 20;\n  const width = 20;\n  const grid = getRowsColumns(height, width);\n  const [rows, setRows] = useState(grid);\n  const [snake, setSnake] = useState([{\n    x: 0,\n    y: 0\n  }]);\n  const [food, setFood] = useState(randomPosition(width, height));\n  const [direction, setDirection] = useState('right');\n  const [startGame, setStartGame] = useState(true);\n  const [speed, setSpeed] = useState(220);\n  const [alive, setAlive] = useState(true);\n  const [score, setScore] = useState(0);\n  const [timestamp, setTimestamp] = useState('no timestamp yet'); // useEffect(() => {\n  //   const [body] = document.getElementsByTagName('body');\n  //   handleGameInput(body);\n  // }, [direction]);\n\n  useEffect(() => {\n    window.addEventListener(\"keydown\", ({\n      key\n    }) => GameInput(key, direction, setDirection)); // subscribeToTimer((err, timestamp) => {\n    //   if (err) {\n    //     console.log(err)\n    //   }\n    //   setTimestamp(timestamp)\n    // });\n    // Remove event listeners on cleanup\n\n    return () => {\n      window.removeEventListener(\"keydown\", GameInput);\n    };\n  }, [direction, setDirection]);\n\n  const setSnakeFoodInGrid = () => {\n    const newRows = grid;\n    snake.forEach(cell => {\n      newRows[cell.x][cell.y] = 'snake';\n    });\n    newRows[food.x][food.y] = 'food';\n    setRows(newRows);\n  };\n\n  const moveSnake = () => {\n    if (startGame) {\n      console.log('DIRECTION ', direction);\n      const newSnake = [];\n\n      switch (direction) {\n        case 'right':\n          if (snake[0].y + 1 >= width) {\n            setSpeed(null);\n            setAlive(false);\n          } else {\n            newSnake.push({\n              x: snake[0].x + 1,\n              y: snake[0].y\n            });\n          }\n\n          break;\n\n        case 'left':\n          if (snake[0].x - 1 < 0) {\n            setSpeed(null);\n            setAlive(false);\n          } else {\n            newSnake.push({\n              x: snake[0].x - 1,\n              y: snake[0].y\n            });\n          }\n\n          break;\n\n        case 'top':\n          if (snake[0].x - 1 < 0) {\n            setSpeed(null);\n            setAlive(false);\n          } else {\n            newSnake.push({\n              x: snake[0].x,\n              y: snake[0].y - 1\n            });\n          }\n\n          break;\n\n        case 'bottom':\n          if (snake[0].x + 1 >= height) {\n            setSpeed(null);\n            setAlive(false);\n          } else {\n            newSnake.push({\n              x: snake[0].x,\n              y: snake[0].y + 1\n            });\n          }\n\n      }\n\n      snake.forEach(cell => {\n        newSnake.push(cell);\n      });\n\n      if (snake[0].x === food.x && snake[0].y === food.y) {\n        setFood(randomPosition(width, height));\n      } else {\n        newSnake.pop();\n      }\n\n      setScore(snake.length);\n      console.log(newSnake);\n      setSnake(newSnake); //setSnakeFoodInGrid();\n    }\n  };\n\n  console.log(snake);\n  useInterval(moveSnake, speed); //requestAnimationFrame(moveSnake);\n\n  return /*#__PURE__*/React.createElement(SnakeCanvas, {\n    snake: snake,\n    food: food,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 5\n    }\n  });\n};\n\nexport default Game;","map":{"version":3,"sources":["/Users/yogi/Code/pe/deep-dive-v1kasjain/projects-exercises/multiplayer-snake-game/frontend/src/Game.js"],"names":["React","useState","useEffect","GameStart","GameOver","randomPosition","getRowsColumns","displayGrid","useInterval","displayScore","GameInput","subscribeToTimer","SnakeCanvas","Game","height","width","grid","rows","setRows","snake","setSnake","x","y","food","setFood","direction","setDirection","startGame","setStartGame","speed","setSpeed","alive","setAlive","score","setScore","timestamp","setTimestamp","window","addEventListener","key","removeEventListener","setSnakeFoodInGrid","newRows","forEach","cell","moveSnake","console","log","newSnake","push","pop","length"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport GameStart from \"./GameStart\";\nimport GameOver from \"./GameOver\";\nimport { randomPosition, getRowsColumns, displayGrid, useInterval, displayScore } from \"./GameHelper\";\nimport GameInput from \"./GameInput\";\nimport { subscribeToTimer } from './Api';\nimport SnakeCanvas from './canvas';\n\n\nconst Game = () => {\n  const height = 20;\n  const width = 20;\n  const grid = getRowsColumns(height, width);\n\n\n  const [rows, setRows] = useState(grid);\n  const [snake, setSnake] = useState([{x:0,y:0}]);\n  const [food, setFood] = useState(randomPosition(width, height));\n  const [direction, setDirection] = useState('right');\n  const [startGame, setStartGame] = useState(true);\n  const [speed, setSpeed] = useState(220);\n  const [alive, setAlive] = useState(true);\n  const [score, setScore] = useState(0);\n  const [timestamp, setTimestamp] = useState('no timestamp yet');\n  \n\n\n  // useEffect(() => {\n  //   const [body] = document.getElementsByTagName('body');\n  //   handleGameInput(body);\n  // }, [direction]);\n  useEffect(() => {\n    window.addEventListener(\"keydown\", ({key})=>GameInput(key, direction, setDirection));\n    // subscribeToTimer((err, timestamp) => {\n    //   if (err) {\n    //     console.log(err)\n    //   }\n    //   setTimestamp(timestamp)\n    // });\n    // Remove event listeners on cleanup\n    return () => {\n      window.removeEventListener(\"keydown\", GameInput);\n    };\n  },[direction, setDirection]);\n\n  const setSnakeFoodInGrid = () => {\n    const newRows = grid;\n    snake.forEach(cell => {\n      newRows[cell.x][cell.y] = 'snake';\n    });\n\n    newRows[food.x][food.y] = 'food';\n    setRows(newRows);\n  };\n\n\n  const moveSnake = () => {\n    if (startGame) {\n      console.log('DIRECTION ' , direction);\n      const newSnake = [];\n      switch (direction) {\n        case 'right':\n          if (snake[0].y + 1 >= width) {\n            setSpeed(null);\n            setAlive(false)\n          } else {\n            newSnake.push({x: snake[0].x + 1, y: snake[0].y});\n          }\n          break;\n        case 'left':\n          if (snake[0].x - 1  < 0) {\n            setSpeed(null);\n            setAlive(false)\n          } else {\n            newSnake.push({x: snake[0].x - 1, y: snake[0].y });\n          }\n          break;\n        case 'top':\n          if (snake[0].x - 1 < 0) {\n            setSpeed(null);\n            setAlive(false)\n          } else {\n            newSnake.push({x: snake[0].x, y: snake[0].y -1});\n          }\n          break;\n        case 'bottom':\n          if (snake[0].x + 1 >= height) {\n            setSpeed(null);\n            setAlive(false)\n          } else {\n            newSnake.push({x: snake[0].x , y: snake[0].y + 1})\n          }\n      }\n      snake.forEach(cell => {\n        newSnake.push(cell);\n      });\n\n      if (snake[0].x === food.x && snake[0].y === food.y) {\n        setFood(randomPosition(width, height));\n      } else {\n        newSnake.pop();\n      }\n      setScore(snake.length);\n      console.log(newSnake);\n      setSnake(newSnake);\n      //setSnakeFoodInGrid();\n    }\n\n  };\n\n  console.log(snake);\n  useInterval(moveSnake, speed);\n  //requestAnimationFrame(moveSnake);\n\n  return (\n    <SnakeCanvas snake={snake} food={food}/>\n  );\n};\n\nexport default Game;\n"]},"metadata":{},"sourceType":"module"}